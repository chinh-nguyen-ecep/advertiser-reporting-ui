<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="rtb.daily_agg_alert_flights_hight_descrepancies" pageWidth="862" pageHeight="595" orientation="Landscape" columnWidth="842" leftMargin="10" rightMargin="10" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA[""]]></defaultValueExpression>
	</parameter>
	<parameter name="p_date" class="java.lang.String">
		<defaultValueExpression><![CDATA[new String("9999-12-31")]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT full_date as "Date"
     , max((dt_lastchange::timestamp with time zone AT TIME ZONE 'America/Los_Angeles'))::timestamp with time zone AT TIME ZONE 'America/New_York' as dt_lastchange
     , exchange as "Exchange"
     , rtbm_adm_flight_id as "RTBM ADM Flight ID"
     , SUM(winnotice_win_cnt) AS "WinNotice Win Count"
     , SUM(adcel_total_requests) AS "AdCel Total Requests"
     , SUM(displayed_impressions) AS "Displayed Impressions"
FROM rtb.daily_agg_alert_flights_hight_descrepancies
WHERE is_active = true AND full_date = $P{p_date}::date
GROUP BY full_date,exchange,rtbm_adm_flight_id
ORDER BY full_date,exchange,rtbm_adm_flight_id]]>
	</queryString>
	<field name="Date" class="java.sql.Date"/>
	<field name="dt_lastchange" class="java.sql.Timestamp"/>
	<field name="Exchange" class="java.lang.String"/>
	<field name="RTBM ADM Flight ID" class="java.lang.Integer"/>
	<field name="WinNotice Win Count" class="java.math.BigDecimal"/>
	<field name="AdCel Total Requests" class="java.math.BigDecimal"/>
	<field name="Displayed Impressions" class="java.math.BigDecimal"/>
	<background>
		<band/>
	</background>
	<title>
		<band height="20">
			<textField>
				<reportElement x="0" y="0" width="243" height="20"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA["Date: "+new SimpleDateFormat("yyyy-MM-dd").format($F{Date})]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="243" y="0" width="599" height="20"/>
				<textElement textAlignment="Right">
					<font size="14" isBold="true"/>
				</textElement>
				<text><![CDATA[Flights With High Descrepancies]]></text>
			</staticText>
		</band>
	</title>
	<columnHeader>
		<band height="20">
			<staticText>
				<reportElement x="0" y="0" width="243" height="20"/>
				<box topPadding="2" leftPadding="5" rightPadding="5">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Exchange]]></text>
			</staticText>
			<staticText>
				<reportElement x="243" y="0" width="169" height="20"/>
				<box topPadding="2" leftPadding="5" rightPadding="5">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[RTBM ADM Flight ID]]></text>
			</staticText>
			<staticText>
				<reportElement x="412" y="0" width="130" height="20"/>
				<box topPadding="2" leftPadding="5" rightPadding="5">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[WinNotice Win Count]]></text>
			</staticText>
			<staticText>
				<reportElement x="542" y="0" width="130" height="20"/>
				<box topPadding="2" leftPadding="5" rightPadding="5">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[AdCel Total Requests]]></text>
			</staticText>
			<staticText>
				<reportElement x="672" y="0" width="170" height="20"/>
				<box topPadding="2" leftPadding="5" rightPadding="5">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.0"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Displayed Impressions]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="20">
			<textField>
				<reportElement x="0" y="0" width="243" height="20"/>
				<box topPadding="2" leftPadding="5" rightPadding="5">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{Exchange}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="243" y="0" width="169" height="20"/>
				<box topPadding="2" leftPadding="5" rightPadding="5">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement/>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{RTBM ADM Flight ID}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="412" y="0" width="130" height="20"/>
				<box topPadding="2" leftPadding="5" rightPadding="5">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right"/>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{WinNotice Win Count}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="542" y="0" width="130" height="20"/>
				<box topPadding="2" leftPadding="5" rightPadding="5">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right"/>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{AdCel Total Requests}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0">
				<reportElement x="672" y="0" width="170" height="20"/>
				<box topPadding="2" leftPadding="5" rightPadding="5">
					<pen lineWidth="0.5"/>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Right"/>
				<textFieldExpression class="java.math.BigDecimal"><![CDATA[$F{Displayed Impressions}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
</jasperReport>
