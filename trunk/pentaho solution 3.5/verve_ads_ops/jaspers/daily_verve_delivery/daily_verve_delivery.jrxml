<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="Verve daily delivery" pageWidth="2786" pageHeight="2380" orientation="Landscape" columnWidth="2746" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.8181818181818254"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="384"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String" isForPrompting="false">
		<defaultValueExpression><![CDATA[""]]></defaultValueExpression>
	</parameter>
	<parameter name="p_date" class="java.lang.String">
		<defaultValueExpression><![CDATA[new String("2015-01-01")]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT max(eastern_date_sk) as date_sk
,max(calendar_year_month) as calendar_year_month
,max(DATE_PART('days',DATE_TRUNC('month', full_date) + '1 MONTH'::INTERVAL    - DATE_TRUNC('month', full_date)))::int AS days_of_month
,max(dt_lastchange) as dt_lastchange
,max(EXTRACT(DAY FROM full_date))::int as current_day
FROM adsops.daily_agg_verve_delivery
WHERE full_date=$P{p_date}::date;]]>
	</queryString>
	<field name="date_sk" class="java.lang.Integer"/>
	<field name="calendar_year_month" class="java.lang.String"/>
	<field name="days_of_month" class="java.lang.Integer"/>
	<field name="dt_lastchange" class="java.sql.Timestamp"/>
	<field name="current_day" class="java.lang.Integer"/>
	<background>
		<band/>
	</background>
	<title>
		<band height="707">
			<image isUsingCache="false" isLazy="true">
				<reportElement x="0" y="0" width="200" height="37"/>
				<imageExpression class="java.lang.String"><![CDATA["http://s3.amazonaws.com/uploads.uservoice.com/logo/design_setting/24549/original/pub_adops_logo.png?1348177717"]]></imageExpression>
			</image>
			<staticText>
				<reportElement x="200" y="0" width="2546" height="37"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" size="24" isBold="true"/>
				</textElement>
				<text><![CDATA[Daily Verve Delivery]]></text>
			</staticText>
			<subreport>
				<reportElement positionType="Float" x="0" y="487" width="2746" height="30"/>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="p_date_sk">
					<subreportParameterExpression><![CDATA[$F{date_sk}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression class="java.lang.String"><![CDATA[$P{SUBREPORT_DIR} + "daily_verve_delivery_subreport_daily_top_20.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement positionType="Float" x="0" y="517" width="2746" height="30"/>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="p_date_sk">
					<subreportParameterExpression><![CDATA[$F{date_sk}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="p_days_of_month">
					<subreportParameterExpression><![CDATA[$F{days_of_month}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="p_calendar_year_month">
					<subreportParameterExpression><![CDATA[$F{calendar_year_month}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression class="java.lang.String"><![CDATA[$P{SUBREPORT_DIR} + "daily_verve_delivery_subreport_summary_daily.jasper"]]></subreportExpression>
			</subreport>
			<staticText>
				<reportElement positionType="Float" x="0" y="547" width="2746" height="20"/>
				<textElement/>
				<text><![CDATA[]]></text>
			</staticText>
			<subreport>
				<reportElement positionType="Float" x="0" y="567" width="2746" height="30"/>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="p_date_sk">
					<subreportParameterExpression><![CDATA[$F{date_sk}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression class="java.lang.String"><![CDATA[$P{SUBREPORT_DIR} + "daily_verve_delivery_subreport_7days_top_20.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement positionType="Float" x="0" y="597" width="2746" height="30"/>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="p_date_sk">
					<subreportParameterExpression><![CDATA[$F{date_sk}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="p_days_of_month">
					<subreportParameterExpression><![CDATA[$F{days_of_month}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="p_calendar_year_month">
					<subreportParameterExpression><![CDATA[$F{calendar_year_month}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="p_date">
					<subreportParameterExpression><![CDATA[$P{p_date}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression class="java.lang.String"><![CDATA[$P{SUBREPORT_DIR} + "daily_verve_delivery_subreport_summary_7days.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement positionType="Float" x="0" y="677" width="2746" height="30"/>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="p_current_day">
					<subreportParameterExpression><![CDATA[$F{current_day}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="p_date_sk">
					<subreportParameterExpression><![CDATA[$F{date_sk}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="p_days_of_month">
					<subreportParameterExpression><![CDATA[$F{days_of_month}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="p_calendar_year_month">
					<subreportParameterExpression><![CDATA[$F{calendar_year_month}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression class="java.lang.String"><![CDATA[$P{SUBREPORT_DIR} + "daily_verve_delivery_subreport_summary_mtd.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement positionType="Float" x="0" y="647" width="2746" height="30"/>
				<subreportParameter name="SUBREPORT_DIR">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="p_date_sk">
					<subreportParameterExpression><![CDATA[$F{date_sk}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression class="java.lang.String"><![CDATA[$P{SUBREPORT_DIR} + "daily_verve_delivery_subreport_mtd_top_20.jasper"]]></subreportExpression>
			</subreport>
			<staticText>
				<reportElement positionType="Float" x="0" y="627" width="2746" height="20"/>
				<textElement/>
				<text><![CDATA[]]></text>
			</staticText>
			<textField pattern="">
				<reportElement x="0" y="37" width="2746" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA["Last update:  "+new SimpleDateFormat("yyyy-MM-dd HH:mm:ss aaa").format($F{dt_lastchange})]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="0" y="57" width="100" height="20" forecolor="#F31515"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Notes*:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="77" width="100" height="30"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Platform:]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="77" width="2646" height="30"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[Derived from ADM property with assumption that all the property under one publisher must have the same value.
If the properties under one publisher have different value, it is set either on or off depend on the last value returned from the update statement]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="107" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Publisher Name:]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="107" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[ADM publisher name]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="122" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[Impressions from DFP for national flights  (flight network_id = 2)]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="122" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[National Imp:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="152" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[VPC Imp:]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="152" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[Impressions from DFP for vpc flights (flight network_id = 6)]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="137" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[Impressions from DFP for VLM flights  (flight network_id = 4)]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="137" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[VLM:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="182" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Remnant Imp:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="212" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[VLM Rev:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="197" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[National Rev:]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="212" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[The same formula with API (imp/1000)*billable_rate ($5 or $3 rule)]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="182" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[Impressions from remnant (verve ads network)]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="197" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[The same formula with API (imp/1000)*flight_rate]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="167" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[Impressions from VLMO network]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="167" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[VLMO Imp:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="272" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Total Rev:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="227" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[VPC Rev:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="242" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[VLMO Rev:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="257" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Remnant Rev:]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="272" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[National Rev + VLM Rev + VPC Rev + VLMO Rev + Remnant Rev]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="227" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[The same formula with API (imp/1000)*billable_rate ($5 or $3 rule)]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="257" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[The same formula with API for remnat revenue calculation]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="242" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[The same formula with API (imp/1000)*tier rate (tier rate is the tier immediately below the last month rate ]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="287" width="2646" height="45"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[Sum of net revenue from national, vlm, vpc, vlmo, remnant.
-Net revenue = revenue *rev share% * correction factor.
-If private buy, the net revenue = (imp/1000)* buy rate]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="287" width="100" height="45"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Total Net Payout:]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="332" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[National Clicks + VLM  Clicks + VPC  Clicks + VLMO  Clicks + Remnant  Clicks]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="332" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Total Clicks:]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="347" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[National imp + VLM  imp + VPC  imp + VLMO  imp + Remnant  imp]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="347" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Filled Req:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="392" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Gross ECPM:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="377" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Filled Rate:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="362" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Total Req:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="407" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Pub ECPM:]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="377" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[(filled_req/total_req)*100]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="362" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[Total adcel request (per publisher) - local imp]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="392" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[ total rev/(filled_req/1000)]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="407" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[Total Net Payout/(filled_req/1000)]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="437" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Verve Profit:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="422" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Verve Margin:]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="422" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[((total Rev - total net Payout)/total Rev)*100]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="437" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[Total Rev - Total Net Payout]]></text>
			</staticText>
			<staticText>
				<reportElement x="100" y="452" width="2646" height="15"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<text><![CDATA[Verve impressions (adimpinternal)]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="452" width="100" height="15"/>
				<textElement>
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Displayed Imps:]]></text>
			</staticText>
			<staticText>
				<reportElement positionType="Float" x="0" y="467" width="2746" height="20"/>
				<textElement/>
				<text><![CDATA[]]></text>
			</staticText>
		</band>
	</title>
</jasperReport>
