<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="dail_ad_network_summary_subreport1" language="groovy" pageWidth="1135" pageHeight="842" orientation="Landscape" columnWidth="1135" leftMargin="0" rightMargin="0" topMargin="0" bottomMargin="0">
	<property name="ireport.zoom" value="1.5"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<parameter name="eastern_date_sk" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="total_adcel_total" class="java.lang.Long"/>
	<parameter name="total_adcel_yes" class="java.lang.Long"/>
	<parameter name="requests" class="java.lang.Long"/>
	<parameter name="paid_impressions" class="java.lang.Long"/>
	<parameter name="clicks" class="java.lang.Long"/>
	<parameter name="net_revenue" class="java.lang.Double"/>
	<queryString>
		<![CDATA[SELECT a.* FROM (
/* AdSense DBCLK Channel */
SELECT      eastern_date_sk, full_date, calendar_year_month, month_since_2005,
            '-1' as ad_network_id, 'AdSense DBCLK Channel' as ad_network_name,
            0 as requests,
            COALESCE(SUM(case impressions_delivered when -1 then null else impressions_delivered end),0) as paid_impressions,
            COALESCE(SUM(case clicks_recorded when -1 then null else clicks_recorded end),0) as clicks,
            COALESCE(SUM(case estimated_earnings when -1 then null else estimated_earnings end),0) as net_revenue,
            0 as fullfilled_code_count,
            0 as fullfilled_code_y
FROM        adnetwork.daily_adsense_dbclk_channel
WHERE       is_active = true AND eastern_date_sk = $P{eastern_date_sk}::int
GROUP BY    eastern_date_sk, full_date, calendar_year_month, month_since_2005
UNION
/* City Grid */
SELECT      eastern_date_sk, full_date, calendar_year_month, month_since_2005,
            '20,29' as ad_network_id, 'City Grid/City Grid Proxy' as ad_network_name,
            COALESCE(SUM(case requests when -1 then null else requests end),0) as requests,
            COALESCE(SUM(case paid_impressions when -1 then null else paid_impressions end),0) as paid_impressions,
            COALESCE(SUM(case clicks when -1 then null else clicks end),0) as clicks,
            COALESCE(SUM(case estimated_net_earnings when -1 then null else estimated_net_earnings end),0) as net_revenue,
            COALESCE(SUM(case fullfilled_code_count when -1 then null else fullfilled_code_count end),0) as fullfilled_code_count,
            COALESCE(SUM(case fullfilled_code_y when -1 then null else fullfilled_code_y end),0) as fullfilled_code_y
FROM        adnetwork.daily_cg_performance
WHERE       is_active = true AND eastern_date_sk = $P{eastern_date_sk}::int
GROUP BY    eastern_date_sk, full_date, calendar_year_month, month_since_2005
UNION
/* City Grid Mobile */
SELECT      eastern_date_sk, full_date, calendar_year_month, month_since_2005,
            '38' as ad_network_id, 'City Grid Mobile' as ad_network_name,
            COALESCE(SUM(case requests when -1 then null else requests end),0) as requests,
            COALESCE(SUM(case paid_impressions when -1 then null else paid_impressions end),0) as paid_impressions,
            COALESCE(SUM(case clicks when -1 then null else clicks end),0) as clicks,
            COALESCE(SUM(case estimated_net_earnings when -1 then null else estimated_net_earnings end),0) as net_revenue,
            COALESCE(SUM(case fullfilled_code_count when -1 then null else fullfilled_code_count end),0) as fullfilled_code_count,
            COALESCE(SUM(case fullfilled_code_y when -1 then null else fullfilled_code_y end),0) as fullfilled_code_y
FROM        adnetwork.daily_cg_mobile_performance
WHERE       is_active = true AND eastern_date_sk = $P{eastern_date_sk}::int
GROUP BY    eastern_date_sk, full_date, calendar_year_month, month_since_2005
UNION
/* iTunes */
SELECT      eastern_date_sk, full_date, calendar_year_month, month_since_2005,
            '-1' as ad_network_id, 'iTunes' as ad_network_name,
            COALESCE(SUM(case requests when -1 then null else requests end),0) as requests,
            COALESCE(SUM(case impressions when -1 then null else impressions end),0) as paid_impressions,
            COALESCE(SUM(case clicks when -1 then null else clicks end),0) as clicks,
            COALESCE(SUM(case revenue when -1 then null else revenue end),0) as net_revenue,
            0,
            0
FROM        adnetwork.daily_it_performance
WHERE       is_active = true AND eastern_date_sk = $P{eastern_date_sk}::int
GROUP BY    eastern_date_sk, full_date, calendar_year_month, month_since_2005
UNION
/* JumpTap */
SELECT      eastern_date_sk, full_date, calendar_year_month, month_since_2005,
            '11' as ad_network_id, 'JumpTap' as ad_network_name,
            COALESCE(SUM(case requests when -1 then null else requests end),0) as requests,
            COALESCE(SUM(case paid_impressions when -1 then null else paid_impressions end),0) as paid_impressions,
            COALESCE(SUM(case clicks when -1 then null else clicks end),-1) as clicks,
            ROUND(COALESCE(SUM(case net_revenue when -1 then null else net_revenue end),0)::NUMERIC,3) as net_revenue,
            COALESCE(SUM(case fullfilled_code_count when -1 then null else fullfilled_code_count end),0) as fullfilled_code_count,
            COALESCE(SUM(case fullfilled_code_y when -1 then null else fullfilled_code_y end),0) as fullfilled_code_y
FROM        adnetwork.daily_jt_performance
WHERE       is_active = true AND eastern_date_sk = $P{eastern_date_sk}::int
GROUP BY    eastern_date_sk, full_date, calendar_year_month, month_since_2005
UNION
/* Millennial Media */
SELECT      eastern_date_sk, full_date, calendar_year_month, month_since_2005,
            '4' as ad_network_id, 'Millennial Media' as ad_network_name,
            COALESCE(SUM(case requests when -1 then null else requests end),0) as requests,
            COALESCE(SUM(case ads_served when -1 then null else ads_served end),0) as paid_impressions,
            COALESCE(SUM(case clicks when -1 then null else clicks end),0) as clicks,
            ROUND(COALESCE(SUM(case net_revenue when -1 then null else net_revenue end),0)::NUMERIC,3) as net_revenue,
            COALESCE(SUM(case fullfilled_code_count when -1 then null else fullfilled_code_count end),0) as fullfilled_code_count,
            COALESCE(SUM(case fullfilled_code_y when -1 then null else fullfilled_code_y end),0) as fullfilled_code_y
FROM        adnetwork.daily_mm_performance
WHERE       is_active = true
AND ((is_estimated=1)OR(is_estimated=0 AND requests>0))
AND eastern_date_sk = $P{eastern_date_sk}::int
GROUP BY    eastern_date_sk, full_date, calendar_year_month, month_since_2005
UNION
/* Marchex */
SELECT      eastern_date_sk, full_date, calendar_year_month, month_since_2005,
            '21,28' as ad_network_id, 'Marchex/Marchex Proxy' as ad_network_name,
            COALESCE(SUM(case total_ad_requests when -1 then null else total_ad_requests end),0) as requests,
            COALESCE(SUM(case paid_impressions when -1 then null else paid_impressions end),0) as paid_impressions,
            COALESCE(SUM(case clicks when -1 then null else clicks end),0) as clicks,
            ROUND(COALESCE(SUM(case "cost" when -1 then null else "cost" end),0)::NUMERIC,3) as net_revenue,
            COALESCE(SUM(case fullfilled_code_count when -1 then null else fullfilled_code_count end),0) as fullfilled_code_count,
            COALESCE(SUM(case fullfilled_code_y when -1 then null else fullfilled_code_y end),0) as fullfilled_code_y
FROM        adnetwork.daily_mx_performance
WHERE       is_active = true AND eastern_date_sk = $P{eastern_date_sk}::int
GROUP BY    eastern_date_sk, full_date, calendar_year_month, month_since_2005
UNION
/* Superpages Proxy/Blue */
SELECT      eastern_date_sk, full_date, calendar_year_month, month_since_2005,
            '30,26' as ad_network_id, 'Superpages Proxy/Blue' as ad_network_name,
            0,
            0,
            0,
            ROUND(COALESCE(SUM(case revenue when -1 then null else revenue end),0)::NUMERIC,3) as net_revenue,
            COALESCE(SUM(case fullfilled_code_count when -1 then null else fullfilled_code_count end),0) as fullfilled_code_count,
            COALESCE(SUM(case fullfilled_code_y when -1 then null else fullfilled_code_y end),0) as fullfilled_code_y
FROM        adnetwork.daily_sp_blue_performance
WHERE       is_active = true AND eastern_date_sk = $P{eastern_date_sk}::int
GROUP BY    eastern_date_sk, full_date, calendar_year_month, month_since_2005
UNION
/* WHERE */
SELECT      eastern_date_sk, full_date, calendar_year_month, month_since_2005,
            '23,25' as ad_network_id, 'Where/Where HTML' as ad_network_name,
            COALESCE(SUM(case requests when -1 then null else requests end),0) as requests,
            COALESCE(SUM(case filled when -1 then null else filled end),0) as paid_impressions,
            COALESCE(SUM(case clicked when -1 then null else clicked end),0) as clicked,
            ROUND(COALESCE(SUM(case revenue when -1 then null else revenue end),0)::NUMERIC,3) as net_revenue,
            COALESCE(SUM(case fullfilled_code_count when -1 then null else fullfilled_code_count end),0) as fullfilled_code_count,
            COALESCE(SUM(case fullfilled_code_y when -1 then null else fullfilled_code_y end),0) as fullfilled_code_y
FROM        adnetwork.daily_wh_performance
WHERE       is_active = true
AND ((is_estimated=1)OR(is_estimated=0 AND requests>0))
AND eastern_date_sk = $P{eastern_date_sk}::int
GROUP BY    eastern_date_sk, full_date, calendar_year_month, month_since_2005
UNION
/* AT&T Yellowpages */
SELECT      eastern_date_sk, full_date, calendar_year_month, month_since_2005,
            '27' as ad_network_id, 'AT&T Yellowpages' as ad_network_name,
            COALESCE(SUM(requests),0) as requests,
            COALESCE(SUM(impressions),0) as paid_impressions,
            COALESCE(SUM(clicks),0) as clicked,
            ROUND(COALESCE(SUM(case revenue when -1 then null else revenue end),0)::NUMERIC,3) as net_revenue,
            COALESCE(SUM(case fullfilled_code_count when -1 then null else fullfilled_code_count end),0) as fullfilled_code_count,
            COALESCE(SUM(case fullfilled_code_y when -1 then null else fullfilled_code_y end),0) as fullfilled_code_y
FROM        adnetwork.daily_yp_performance
WHERE       is_active = true AND eastern_date_sk = $P{eastern_date_sk}::int
GROUP BY    eastern_date_sk, full_date, calendar_year_month, month_since_2005
UNION
/* AT&T Static Banner Yellowpages */
SELECT      eastern_date_sk, full_date, calendar_year_month, month_since_2005,
            '32' as ad_network_id, 'AT&T Static Banner Yellowpages' as ad_network_name,
            COALESCE(SUM(requests),0) as requests,
            COALESCE(SUM(impressions),0) as paid_impressions,
            COALESCE(SUM(clicks),0) as clicked,
            ROUND(COALESCE(SUM(case revenue when -1 then null else revenue end),0)::NUMERIC,3) as net_revenue,
            COALESCE(SUM(case fullfilled_code_count when -1 then null else fullfilled_code_count end),0) as fullfilled_code_count,
            COALESCE(SUM(case fullfilled_code_y when -1 then null else fullfilled_code_y end),0) as fullfilled_code_y
FROM        adnetwork.daily_yp_sb_performance
WHERE       is_active = true AND eastern_date_sk = $P{eastern_date_sk}::int
GROUP BY    eastern_date_sk, full_date, calendar_year_month, month_since_2005
UNION
/* AT&T No Logo Yellowpages */
SELECT      eastern_date_sk, full_date, calendar_year_month, month_since_2005,
            '33' as ad_network_id, 'AT&T No Logo Yellowpages' as ad_network_name,
            COALESCE(SUM(requests),0) as requests,
            COALESCE(SUM(impressions),0) as paid_impressions,
            COALESCE(SUM(clicks),0) as clicked,
            ROUND(COALESCE(SUM(case revenue when -1 then null else revenue end),0)::NUMERIC,3) as net_revenue,
            COALESCE(SUM(case fullfilled_code_count when -1 then null else fullfilled_code_count end),0) as fullfilled_code_count,
            COALESCE(SUM(case fullfilled_code_y when -1 then null else fullfilled_code_y end),0) as fullfilled_code_y
FROM        adnetwork.daily_yp_no_performance
WHERE       is_active = true AND eastern_date_sk = $P{eastern_date_sk}::int
GROUP BY    eastern_date_sk, full_date, calendar_year_month, month_since_2005
UNION
/* KlickThru */
SELECT      eastern_date_sk, full_date, calendar_year_month, month_since_2005,
            '35' as ad_network_id, 'KlickThru' as ad_network_name,
            0 as requests,
            COALESCE(SUM(paid_impressions),0) as paid_impressions,
            COALESCE(SUM(clicks),0) as clicked,
            ROUND(COALESCE(SUM(case revenue when -1 then null else revenue end),0)::NUMERIC,3) as net_revenue,
            COALESCE(SUM(case fullfilled_code_count when -1 then null else fullfilled_code_count end),0) as fullfilled_code_count,
            COALESCE(SUM(case fullfilled_code_y when -1 then null else fullfilled_code_y end),0) as fullfilled_code_y
FROM        adnetwork.daily_kt_performance
WHERE       is_active = true AND eastern_date_sk = $P{eastern_date_sk}::int
GROUP BY    eastern_date_sk, full_date, calendar_year_month, month_since_2005
UNION
/* AdMarvel */
SELECT      eastern_date_sk, full_date, calendar_year_month, month_since_2005,
            '50' as ad_network_id, 'AdMarvel' as ad_network_name,
            COALESCE(SUM(requests),0) as requests,
            COALESCE(SUM(impressions),0) as paid_impressions,
            COALESCE(SUM(clicks),0) as clicked,
            ROUND(COALESCE(SUM(case revenue when -1 then null else revenue end),0)::NUMERIC,3) as net_revenue,
            COALESCE(SUM(case responses_count when -1 then null else responses_count end),0) as fullfilled_code_count,
            COALESCE(SUM(case filled_requests when -1 then null else filled_requests end),0) as fullfilled_code_y
FROM        adnetwork.daily_am_performance
WHERE       is_active = true AND eastern_date_sk = $P{eastern_date_sk}::int
GROUP BY    eastern_date_sk, full_date, calendar_year_month, month_since_2005
) a
ORDER BY ad_network_name]]>
	</queryString>
	<field name="eastern_date_sk" class="java.lang.Integer"/>
	<field name="full_date" class="java.sql.Date"/>
	<field name="calendar_year_month" class="java.lang.String"/>
	<field name="month_since_2005" class="java.lang.Integer"/>
	<field name="ad_network_id" class="java.lang.String"/>
	<field name="ad_network_name" class="java.lang.String"/>
	<field name="requests" class="java.lang.Double"/>
	<field name="paid_impressions" class="java.lang.Double"/>
	<field name="clicks" class="java.lang.Long"/>
	<field name="net_revenue" class="java.lang.Double"/>
	<field name="fullfilled_code_count" class="java.lang.Long"/>
	<field name="fullfilled_code_y" class="java.lang.Long"/>
	<variable name="Total Ad Requests sum" class="java.lang.Integer" calculation="Sum">
		<variableExpression><![CDATA[$F{requests}]]></variableExpression>
		<initialValueExpression><![CDATA[-1]]></initialValueExpression>
	</variable>
	<variable name="Paid Impressions" class="java.lang.Integer" calculation="Sum">
		<variableExpression><![CDATA[$F{paid_impressions}]]></variableExpression>
	</variable>
	<variable name="Clicks sum" class="java.lang.Integer" calculation="Sum">
		<variableExpression><![CDATA[$F{clicks}]]></variableExpression>
	</variable>
	<variable name="Revenue sum" class="java.lang.Double" calculation="Sum">
		<variableExpression><![CDATA[$F{net_revenue}]]></variableExpression>
	</variable>
	<variable name="Adcel_total" class="java.lang.Integer" calculation="Sum">
		<variableExpression><![CDATA[$F{fullfilled_code_count}]]></variableExpression>
	</variable>
	<variable name="Adcel_Yes" class="java.lang.Integer" calculation="Sum">
		<variableExpression><![CDATA[]]></variableExpression>
	</variable>
	<columnHeader>
		<band height="45" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="22" width="205" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Ad Network Name (ID)]]></text>
			</staticText>
			<line>
				<reportElement x="0" y="44" width="1135" height="1"/>
			</line>
			<staticText>
				<reportElement x="0" y="0" width="205" height="20"/>
				<textElement>
					<font fontName="Arial" size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Performance By Ad Networks:]]></text>
			</staticText>
			<staticText>
				<reportElement x="575" y="22" width="140" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Clicks]]></text>
			</staticText>
			<staticText>
				<reportElement x="715" y="22" width="140" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Revenue]]></text>
			</staticText>
			<staticText>
				<reportElement x="855" y="22" width="140" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Adcel's Reps]]></text>
			</staticText>
			<staticText>
				<reportElement x="995" y="22" width="140" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Adcel's Ys]]></text>
			</staticText>
			<staticText>
				<reportElement x="295" y="22" width="140" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Total Ad Rqs]]></text>
			</staticText>
			<staticText>
				<reportElement x="435" y="22" width="140" height="20"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<text><![CDATA[Paid Imps]]></text>
			</staticText>
		</band>
	</columnHeader>
	<detail>
		<band height="20" splitType="Stretch">
			<textField>
				<reportElement x="0" y="0" width="205" height="20"/>
				<textElement>
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{ad_network_name}+ " (" + $F{ad_network_id} + ")"]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="295" y="0" width="140" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{requests}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="995" y="0" width="140" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{fullfilled_code_y}]]></textFieldExpression>
			</textField>
			<textField pattern="###0.00;-###0.00">
				<reportElement x="715" y="0" width="140" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.Double"><![CDATA[$F{net_revenue}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="435" y="0" width="140" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{paid_impressions}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="575" y="0" width="140" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{clicks}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="855" y="0" width="140" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Arial"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$F{fullfilled_code_count}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<summary>
		<band height="43">
			<textField pattern="#,###;-#,###">
				<reportElement x="435" y="4" width="140" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$P{paid_impressions}]]></textFieldExpression>
			</textField>
			<textField pattern="#,###;-#,###">
				<reportElement x="575" y="4" width="140" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$P{clicks}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00;-#,##0.00">
				<reportElement x="715" y="4" width="140" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.Double"><![CDATA[$P{net_revenue}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="0" y="1" width="1135" height="1"/>
			</line>
			<textField pattern="#,###;-#,###">
				<reportElement x="855" y="4" width="140" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$P{total_adcel_total}]]></textFieldExpression>
			</textField>
			<textField pattern="#,###;-#,###">
				<reportElement x="995" y="4" width="140" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$P{total_adcel_yes}]]></textFieldExpression>
			</textField>
			<textField pattern="#,###;-#,###">
				<reportElement x="295" y="4" width="140" height="20"/>
				<textElement textAlignment="Right">
					<font fontName="Arial" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$P{requests}]]></textFieldExpression>
			</textField>
		</band>
	</summary>
</jasperReport>
